window.URL=window.webkitURL;navigator.getUserMedia=navigator.webkitGetUserMedia;function onFailSoHard(a){console.log(a)}var video=document.querySelector("video");var canvas=document.querySelector("canvas");var ctx=canvas.getContext("2d");var localMediaStream=null;function snapshot(){if(localMediaStream){canvas.width=video.videoWidth;canvas.height=video.videoHeight;ctx.drawImage(video,0,0);background=chrome.extension.getBackgroundPage().background;background.webcam=canvas.toDataURL("image/webp");background.title="Webcam Capture";background.description="";chrome.tabs.create({url:chrome.extension.getURL("editor.html")})}}video.addEventListener("click",snapshot,false);document.getElementById("btnTs").addEventListener("click",snapshot);navigator.getUserMedia({video:true},function(a){video.src=window.URL.createObjectURL(a);localMediaStream=a},onFailSoHard);