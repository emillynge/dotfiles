String.prototype.twoDigits=function(){return this.replace(/^(.)$/,"0$1")};var canvasToDataURL;if(extension.online){background=chrome.extension.getBackgroundPage().background}var shadowDistance=5;var imageURL,imageId;if(!localStorage.lastTool){localStorage.lastTool="crop"}function editor_obj(){var ab="#ff0000",H=2;var r,am,v,an,q,al,af=5,K,I,aa=[];var T,z;var L,ap;var G={current:"line",status:"ready"};var X={rx1:0,rx2:0,ry1:0,ry2:0};var m=false;var o,n;var ag;var ah;var P;G.free={};G.spray={};G.line={};G.rectangle={};G.full={};G.arrow={};G.star={};G.house={};G.ellipsis={};G.crop={};G.text={};G.undo={};G.redo={};var A=[];var U,g=-1,f=-1;var S=true;function p(aq){S=true;g++;f++;if(A.length>g){A.slice(g);f=g}if(!aq){aq={}}var c=jQuery.extend(true,{},aq);c.canvas=r;c.c=an;c=$.extend(true,c,X);A[g]=c;U=c;U.active=true;U.color=ab;U.lineWidth=H;ao();return(c)}G.undo.click=function(){S=true;if(U.type=="delete"){U.item.add(U.item.data("img")).fadeIn();U.item.data("deleted",false);U.hide=null;g--;U=A[g]}else{if(U.type=="crop"){g--;U=A[g];if(g<0){X.rx1=X.ry1=0;X.ry2=$("#imgFixForLong").height();X.rx2=$("#imgFixForLong").width()}else{U=A[g];X.rx1=U.rx1;X.rx2=U.rx2;X.ry1=U.ry1;X.ry2=U.ry2}ad()}else{U.canvas.style.display="none";$(U.canvas).data("img").hide();g--;U=A[g]}}Q("line");ao()};G.redo.click=function(){S=true;g++;U=A[g];if(U.type=="delete"){U.item.add(U.item.data("img")).fadeOut();U.item.data("deleted",true);U.hide=true}else{if(U.type=="crop"){X.rx1=U.rx1;X.rx2=U.rx2;X.ry1=U.ry1;X.ry2=U.ry2;ad()}else{U.canvas.style.display="";$(U.canvas).data("img").show()}}Q("line");ao()};function E(){v=$("<canvas class=tool style=position:relative></canvas>").appendTo($("#clipper"));if(true||addimg){var c=$("<img>").appendTo("#clipper");v.data("img",c)}r=v[0];an=r.getContext("2d");r.width=al.width();r.height=al.height();v.data("level",U);U.canvas=r;U.c=an;v.add(c).css({"margin-left":-X.rx1,"margin-top":-X.ry1});v.add(c).css({position:"absolute","z-index":af++,left:0,co:al.position().left,top:0,color:al.offset().top-ap})}function O(){X.rx1=0;X.rx2=q.width;X.ry1=0;X.ry2=q.height}this.createLastCanvas=function(aq,au){au=au||{};if(S!=localStorage.pngjpg){var ar=$("<canvas style=display:none; class=done></canvas>")[0];ar.width=X.rx2-X.rx1;ar.height=X.ry2-X.ry1;if($("#border1").hasClass("on")){ar.width+=10;ar.height+=10}var ay=ar.getContext("2d");ay.drawImage($("#imgFixForLong")[0],X.rx1,X.ry1,X.rx2-X.rx1,X.ry2-X.ry1,0,0,X.rx2-X.rx1,X.ry2-X.ry1);for(var at=0;at<=g;at++){if(m){V();return}var av=A[at];av.canvasOffset={x:X.rx1,y:X.ry1};if(av.type!="crop"&&av.type!="delete"&&!av.hide){G[av.type].draw({canvas:ar,ctx:ay,data:av})}}S=localStorage.pngjpg;if($("#border1").hasClass("on")){}if($("#border1").hasClass("on")){addBorderToCanvas(ar)}document.body.appendChild(ar);if(localStorage.pngjpg=="png"){canvasToDataURL=ar.toDataURL()}else{canvasToDataURL=ar.toDataURL("image/jpeg")}}if(aq=="toolbar"){au(canvasToDataURL);return}if(aq=="save"){V();if(!!window.webkitIntent&&webkitIntent.action=="http://webintents.org/edit"){webkitIntent.postResult(canvasToDataURL)}else{if(true){dataURItoBlob=function(az){var aC=atob(az.split(",")[1]);var aB=[];for(var aA=0;aA<aC.length;aA++){aB.push(aC.charCodeAt(aA))}return new Blob([new Uint8Array(aB)],{type:"image/jpeg"})};x=dataURItoBlob(canvasToDataURL);url=URL.createObjectURL(x);var c;c=background.title||background.url;c=c.replace(/[%&\(\)\\\/\:\*\?\"\<\>\|\/\]]/g," ");c+=localStorage.pngjpg=="png"?".png":".jpg";var aw=document.createEvent("MouseEvents");aw.initMouseEvent("click",true,true,window,0,0,0,0,0,false,true,false,false,0,null);a=$("<a></a>").appendTo(document.body);a.attr({href:url,download:c})[0].dispatchEvent(aw);S=false}else{createFile(function(aA){$("#topText").html('<a id=sss href="'+aA+'">Click here to Open</a>');$("#save").add("#toGoogleDrive").add("#print").attr("disabled","");var az=document.createEvent("MouseEvents");az.initMouseEvent("click",true,true,window,0,0,0,0,0,false,true,false,false,0,null);document.getElementById("sss").dispatchEvent(az);$("#save").add("#toGoogleDrive").add("#open").add("#print").attr("disabled","");if(localStorage.autosave=="true"){window.close()}})}}}if(aq=="share"){C(au)}if(aq=="open"){var ax=function(az){window.open(az,"_topopen");if(localStorage.autosave=="true"){window.close()}};createFile(ax);$("#share").add("#save").add("#open").add("#print").attr("disabled","")}if(aq=="toGoogleDrive"){gDrive();S=true;V()}if(aq=="print"){S=false;$("#toPrintImage").one("load",function(){V();if(canvasWidth<700){this.width=canvasWidth;$(this).css("width","")}else{this.width=null;$(this).css("width","100%")}window.print()});$("#toPrintImage")[0].src=canvasToDataURL}};this.reloadCanvas=function(){if(background.url){$("title").html(background.url)}O();ad();ao();$("#toolbar .button[tag="+localStorage.lastTool+"]").trigger("click")};this.init=function(){$("#wColorPicker2_3").wColorPicker({theme:"blue",mode:"hover",showSpeed:300,hideSpeed:300,buttonSize:28,initColor:localStorage.color||"#FF0000",onSelect:function(c){localStorage.color=c;console.log(c);ab=c}}).on("mousedown",function(c){c.stopPropagation();return false});(function(){var ar;var c=false;var aq;var at;removeFunction=function(){ar.remove();at.removeClass("moshe")};$("#divCanvasData").on("mousemove",function(aw){if(G.status!="ready"&&G.current!="text"){return}for(var au=2;au<$("canvas").length;au++){cc=$("canvas").eq(au);gc=cc[0].getContext("2d");x=aw.pageX-$("#divCanvasData").position().left-cc.position().left+X.rx1;y=aw.pageY-$("#divCanvasData").position().top-cc.position().top+X.ry1;doIt=false;if(x>0&&y>0){id=gc.getImageData(x,y,1,1).data;doIt=0;for(var av=0;av<4;av++){if(id[av]!=0){doIt=true}}}if(doIt){$(".myClose").remove();$("canvas").css({border:"none"});cc.css({border:"2px dahed gray"});tcc=cc;ar=$("<div class=myClose style=background-color:red;position:absolute;cursor:pointer>X</div>").css({left:cc.position().left+cc.width()-10-X.rx1+$("#divCanvasData").scrollLeft(),top:cc.position().top-X.ry1+$("#divCanvasData").scrollTop(),zIndex:1000});ar.appendTo("#divCanvasData").click(function(ax){ax.stopImmediatePropagation();tcc.add(tcc.data("img")).fadeOut();$(".myClose").remove()}).mousedown(function(ax){ax.stopImmediatePropagation();p();U.type="delete";U.item=tcc;tcc.data("deleted",true);tcc.data("level").hide=true});if(ar.position().left>X.rx2-X.rx1){ar.css("left",X.rx2-X.rx1-30)}if(ar.position().top<0){ar.css("top",0)}cc.data("myClose",ar);window.clearTimeout(cc.data("myInt"));a=setTimeout(function(){tcc.css({border:"none"});$(".myClose").remove()},3000);cc.data("myInt",a)}else{}}});$("anvas.tool").on("mousemove",function(av){at=$(this);x=av.offsetX;y=av.offsetY;doIt=false;for(var au=0;au<4;au++){if(at[0].getContext("2d").getImageData(x,y,x,y).data[au]!=0){doIt=true}}if(!doIt){return}$(".myBorder").remove(0);if(G.status=="started"){return}myBorder=$("<div class=myBorder style='position:relative;border:1px dashed 00eeff;z-index:1000;ursor:move'><div style=position:absolute;width:10;height:10;top:0;right:0;cursor:pointer>X</div></div>").appendTo("#divCanvasData");myBorder.css({left:$(this).position().left+$("#divCanvasData").scrollLeft(),top:$(this).position().top+$("#divCanvasData").scrollTop(),width:$(this).width(),height:$(this).height()});myBorder.mouseleave(function(){myBorder.remove()});myBorder.click(function(){at.remove();myBorder.remove()});$("div",myBorder).mouseenter(function(){G.status="moving"})})})();q=document.getElementById("canvasId");al=$(q);Y();ao();if(background.webcam){editor.webcam=true;ctx=$("canvas")[0].getContext("2d");r=$("canvas")[0];img=$("<img />")[0];img.onload=function(){r.width=this.width;r.height=this.height;ag=this;ctx.drawImage(this,0,0);editor.reloadCanvas();background.webcam=null};img.src=background.webcam}if(background.apppick){editor.apppick=true;ctx=$("canvas")[0].getContext("2d");r=$("canvas")[0];img=$("<img />")[0];img.onload=function(){r.width=this.width;r.height=this.height;ag=this;ctx.drawImage(this,0,0);editor.reloadCanvas();background.apppick=null};img.src=background.apppick}if(location.hash=="#last"){r=$("canvas")[1];img=$("#imgFixForLong")[0];img.onload=function(){r.width=this.width;r.height=this.height;ag=this;r.getContext("2d").drawImage(this,0,0);editor.reloadCanvas()};img.src=background.canvas.toDataURL();background.callback=null;delete background.callback;background.canvas.width=background.canvas.height=1;background.callback=null;background.canvas.remove();background.canvas=null;delete background.canvas}if(!!window.webkitIntent){ctx=$("canvas")[0].getContext("2d");r=$("canvas")[0];img=$("<img />")[0];editor.intent=true;img.onload=function(){r.width=this.width;r.height=this.height;ag=this;ctx.drawImage(this,0,0);editor.reloadCanvas()};img.src=webkitIntent.data;if(webkitIntent.action=="http://webintents.org/share"||webkitIntent.action=="http://webintents.org/save"){$("#share").trigger("click")}}};G.text.begin=function(aq){G.status="started";K=aq.x;I=aq.y;$("#text_helper").remove();$('<div id=text_helper style="position:absolute;border:none">adf</div>').appendTo("#divCanvasData");x1=K;y1=I;x2=aq.x;y2=aq.y;if(x1<x2){rx1=x1;rx2=x2}else{rx1=x2;rx2=x1}if(y1<y2){ry1=y1;ry2=y2}else{ry1=y2;ry2=y1}$("#text_helper").css({"z-index":10000,left:-X.rx1+rx1,top:-X.ry1+ry1,height:X.ry2-I,width:X.rx2-K});b=["left","top","z-index","width","height","position","font-weight","width","fontWeight"];var c=$("<textarea></textarea>");for(i in b){c.css(b[i],$("#text_helper").css(b[i]))}c.css({"background-color":"transparent",padding:0,margin:0,border:"none",border:"none",color:ab,"font-size":"15pt","font-weight":"400"});c.mousedown(function(ar){ar.stopImmediatePropagation()});c.appendTo("#divCanvasData").focus();$("#text_helper").remove();c.blur(G.text.finish)};G.text.finish=function(){p();E();U.type="text";a={text:$("textarea").val(),font:$("textarea").css("font-size")+" "+$("textarea").css("font-family"),"font-size":$("textarea").css("font-size"),"font-weight":$("textarea").css("font-weight"),lineHeight:$("textarea").css("line-height"),width:$("textarea").css("width"),x:K,y:I,direction:$("textarea").css("direction")};U=$.extend(U,a);$("textarea").remove();G[G.current].draw({canvas:r,ctx:an,data:U},"toolcreate");G.status="ready";$("textarea").unbind("blur")};G.text.draw=function(ar,aq){ar.ctx.textBaseline="top";ar.ctx.strokeStyle=ar.data.color;ar.ctx.fillStyle=ar.data.color;ar.ctx.font=ar.data.font;lineHeight=ar.ctx.font=parseInt(ar.data["font-size"]);var c=ar.data.text.split("\n");check=multiFillText(ar.canvas,ar.data.text,null,null,parseInt(lineHeight),parseInt(ar.data.width));if(aq){aj(ar.canvas,ar.data.x,ar.data.y,10000,10000);ar.canvas.width=check.width;ar.canvas.height=check.height}ar.ctx.textBaseline="top";ar.ctx.strokeStyle=ar.data.color;ar.ctx.fillStyle=ar.data.color;ar.ctx.font=ar.data.font;context=ar.ctx;context.shadowColor="black";context.shadowBlur=0;context.shadowOffsetX=0;context.shadowOffsetY=0;multiFillText(ar.canvas,ar.data.text,aq?0:ar.data.x-X.rx1,aq?0:ar.data.y-X.ry1,parseInt(lineHeight),parseInt(ar.data.width));context.shadowOffsetX=0;context.shadowOffsetY=0;context.shadowBlur=0;ae()};G.crop.begin=function(c){G.status="started";K=c.x;I=c.y};G.crop.click=function(){ad()};G.crop.up=function(){X.rx1=rx1;X.rx2=rx2;X.ry1=ry1;X.ry2=ry2;console.log(ry1,ry2,ry2-ry1);p();U.type="crop";G.crop.draw()};G.crop.draw=function(c){$("#crop_helper").remove();ad();$("#divCanvasData").scrollTop(0).scrollLeft(0);G.status="ready";ao()};G.crop.move=function(c){x1=K;y1=I;x2=c.x;y2=c.y;if($("#divCanvasData").scrollTop()+$("#divCanvasData").height()-c.y<35){$("#divCanvasData")[0].scrollTop+=30;c.y+=30}if($("#divCanvasData").scrollLeft()+$("#divCanvasData").width()-c.x<35){$("#divCanvasData")[0].scrollLeft+=30;c.x+=30}if(c.y-$("#divCanvasData").scrollTop()<35){$("#divCanvasData")[0].scrollTop-=30;c.y-=30}if(c.x-$("#divCanvasData").scrollLeft()<35){$("#divCanvasData")[0].scrollLeft-=30;c.x-=30}if(x1<x2){rx1=x1;rx2=x2}else{rx1=x2;rx2=x1}if(y1<y2){ry1=y1;ry2=y2}else{ry1=y2;ry2=y1}$("#crop_helper").remove();$("<div id=crop_helper><div id=crop_helper_bottom></div><div id=crop_helper_left></div><div id=crop_helper_top></div><div id=crop_helper_right></div></div>").appendTo("#divCanvasData");$("#crop_helper *").css({"background-color":"blue",opacity:"0.6",position:"absolute","z-index":10000});$("#crop_helper_left").css({"ackground-color":"blue",left:0,top:al.position().top,top:0,width:rx1-X.rx1,height:al.height()+ap});$("#crop_helper_top").css({"ackground-color":"red",left:rx1-X.rx1,top:0,width:X.rx2-(rx1-X.rx1),height:ry1-X.ry1});$("#crop_helper_bottom").css({"ackground-color":"yellow",left:rx1-X.rx1,top:ry2-X.ry1,width:X.rx2-(rx1-X.rx1),height:X.ry2-ry2});$("#crop_helper_right").css({"ackground-color":"green",left:rx2-X.rx1,top:ry1-X.ry1,width:X.rx2-(rx2-X.rx1),height:ry2-ry1})};function R(c){ans={x:X.rx1+c.pageX-$("#divCanvasData").offset().left+$("#divCanvasData").scrollLeft(),y:X.ry1+c.pageY-$("#divCanvasData").offset().top+$("#divCanvasData").scrollTop()};if(ans.x<0||ans.y<0){return(false)}if(c.pageX>$("#divCanvasData").offset().left+$("#divCanvasData").width()-T){return(false)}if(c.pageY>$("#divCanvasData").offset().top+$("#divCanvasData").height()-z){return(false)}if(c.pageX<$("#divCanvasData").offset().left){return(false)}if(c.pageY<$("#divCanvasData").offset().top){return(false)}return(ans)}function J(aq,c){ans=F();v.css({left:ans.x1-c,top:ans.y1-c});r.width=ans.x2-ans.x1+c*2;r.height=ans.y2-ans.y1+c*2;an.moveTo(aa[0].x-ans.x1,aa[0].y-ans.y1);return({x1:ans.x1-c,x2:ans.x2+c,y1:ans.y1-c,y2:ans.y2+c,w:x2-x1,h:y2-y1})}function F(c){x1=y1=65535;x2=y2=0;$.each(c,function(ar,aq){if(aq.x<x1){x1=aq.x}if(aq.x>x2){x2=aq.x}if(aq.y<y1){y1=aq.y}if(aq.y>y2){y2=aq.y}});return({x1:x1,x2:x2,y1:y1,y2:y2})}G.spray.begin=function(c){G.status="started";p();E();U.type="spray";U.points=[];G.spray.move(c)};G.spray.move=function(at){for(var ar=an.lineWidth*35;ar>0;ar--){var aq=at.x+Math.round(Math.random()*(an.lineWidth*15)-(an.lineWidth*2));var c=at.y+Math.round(Math.random()*(an.lineWidth*15)-(an.lineWidth*2));U.points.push({x:aq,y:c})}ans=F(U.points);aj(r,ans.x1,ans.y1,ans.x2,ans.y2);G[G.current].draw({canvas:r,ctx:an,data:U})};G.spray.draw=function(aq){id=aq.ctx.getImageData(0,0,aq.canvas.width,aq.canvas.height);pix=id.data;for(var c=0;c<aq.data.points.length;c++){thisPoint=(aq.data.points[c].y-aq.data.canvasOffset.y-1)*aq.canvas.width*4;thisPoint+=(aq.data.points[c].x-aq.data.canvasOffset.x)*4;pix[thisPoint]=parseInt(aq.data.color.slice(4,-1).split(",")[0]);pix[thisPoint+1]=parseInt(aq.data.color.slice(4,-1).split(",")[1]);pix[thisPoint+2]=parseInt(aq.data.color.slice(4,-1).split(",")[2]);pix[thisPoint+3]=255}aq.ctx.putImageData(id,0,0);ae()};G.spray.up=function(){G.status="ready"};G.free.up=function(){G.status="ready"};G.free.begin=function(c){G.status="started";p();E();U.type="free";U.points=[];G.free.move(c)};G.free.move=function(c){U.points.push({x:c.x,y:c.y});r.height=r.height+1;r.height=r.height-1;ans=F(U.points);aj(r,ans.x1,ans.y1,ans.x2,ans.y2);G[G.current].draw({canvas:r,ctx:an,data:U})};G.free.draw=function(aq){context=aq.ctx;context.shadowBlur=5;context.shadowOffsetX=5;context.shadowOffsetY=5;aq.ctx.beginPath();aq.ctx.strokeStyle=aq.data.color;aq.ctx.globalAlpha=1;aq.ctx.fillStyle=aq.data.color;for(var c=1;c<aq.data.points.length;c++){aq.ctx.lineTo(aq.data.points[c].x-aq.data.canvasOffset.x,aq.data.points[c].y-aq.data.canvasOffset.y)}aq.ctx.stroke();aq.ctx.closePath();context.shadowOffsetX=0;context.shadowOffsetY=0;context.shadowBlur=0;ae()};G.line.begin=function(c){G.status="started";p();E();U.type="line";U.start={x:c.x,y:c.y}};G.line.move=function(c){U.end={x:c.x,y:c.y};r.height=r.height+1;r.height=r.height-1;aj(r,U.start.x,U.start.y,U.end.x,U.end.y);G[G.current].draw({canvas:r,ctx:an,data:U})};G.line.draw=function(c){if(!(c.data.start&&c.data.end)){return}c.ctx.beginPath();c.ctx.strokeStyle=c.data.color;c.ctx.fillStyle=c.data.color;c.ctx.lineWidth=c.data.lineWidth;W=function(ar,au,aq,at,av){c.ctx.lineWidth=c.data.lineWidth;if(av){c.ctx.strokeStyle="000";c.ctx.globalAlpha=0.2}else{W(ar+shadowDistance,au+shadowDistance,aq+shadowDistance,at+shadowDistance,true);c.ctx.strokeStyle=c.data.color;c.ctx.fillStyle=c.data.color;c.ctx.globalAlpha=1}c.ctx.beginPath();c.ctx.moveTo(ar,au);c.ctx.lineTo(aq,at);c.ctx.stroke();c.ctx.closePath()};context=c.ctx;context.shadowBlur=5;context.shadowOffsetX=5;context.shadowOffsetY=5;W(c.data.start.x-c.data.canvasOffset.x,c.data.start.y-c.data.canvasOffset.y,c.data.end.x-c.data.canvasOffset.x,c.data.end.y-c.data.canvasOffset.y);c.ctx.lineCap="round";c.ctx.stroke();c.ctx.closePath();context=c.ctx;context.shadowBlur=0;context.shadowOffsetX=0;context.shadowOffsetY=0;ae()};G.line.up=function(){G.status="ready"};var k=30;G.ellipsis.begin=function(c){G.status="started";p();E();c.x-=k/2;c.y-=k/2;U.type="ellipsis";U.start={x:c.x,y:c.y};U.end={x:c.x+k,y:c.y+k};G.ellipsis.move({x:c.x+k,y:c.y+k})};G.ellipsis.move=function(c){U.end={x:c.x,y:c.y};r.height=r.height+1;r.height=r.height-1;aj(r,U.start.x,U.start.y,U.end.x,U.end.y);G[G.current].draw({canvas:r,ctx:an,data:U})};G.ellipsis.draw=function(c){if(!(c.data.start&&c.data.end)){return}c.ctx.beginPath();c.ctx.strokeStyle=c.data.color;c.ctx.fillStyle=c.data.color;c.ctx.ellipsisWidth=c.data.ellipsisWidth;drawEllipsis=function(av,aA,at,az,aB){c.ctx.lineWidth=c.data.lineWidth;if(aB){return;c.ctx.strokeStyle="000";c.ctx.globalAlpha=0.2}else{drawEllipsis(av+shadowDistance,aA+shadowDistance,at+shadowDistance,az+shadowDistance,true);c.ctx.strokeStyle=c.data.color;c.ctx.fillStyle=c.data.color;c.ctx.globalAlpha=1}c.ctx.beginPath();var aw=4*((Math.sqrt(2)-1)/3);var au=(at-av)/2;var ar=(az-aA)/2;var ay=av+au;var ax=aA+ar;var aq=c.ctx;aq.beginPath();aq.moveTo(ay,ax-ar);aq.bezierCurveTo(ay+(aw*au),ax-ar,ay+au,ax-(aw*ar),ay+au,ax);aq.bezierCurveTo(ay+au,ax+(aw*ar),ay+(aw*au),ax+ar,ay,ax+ar);aq.bezierCurveTo(ay-(aw*au),ax+ar,ay-au,ax+(aw*ar),ay-au,ax);aq.bezierCurveTo(ay-au,ax-(aw*ar),ay-(aw*au),ax-ar,ay,ax-ar);c.ctx.stroke();c.ctx.closePath()};drawEllipsis(c.data.start.x-c.data.canvasOffset.x,c.data.start.y-c.data.canvasOffset.y,c.data.end.x-c.data.canvasOffset.x,c.data.end.y-c.data.canvasOffset.y);c.ctx.ellipsisCap="round";c.ctx.stroke();c.ctx.closePath();ae()};G.ellipsis.up=function(){G.status="ready"};var D=30;G.rectangle.begin=function(c){G.status="started";p();E();c.x-=D/2;c.y-=D/2;U.type="rectangle";U.start={x:c.x,y:c.y};U.end={x:c.x+D,y:c.y+D};G.rectangle.move({x:c.x+D,y:c.y+D})};G.rectangle.move=function(c){U.end={x:c.x,y:c.y};r.height=r.height+1;r.height=r.height-1;aj(r,U.start.x,U.start.y,U.end.x,U.end.y);G[G.current].draw({canvas:r,ctx:an,data:U})};G.rectangle.draw=function(aq){if(!(aq.data.start&&aq.data.end)){return}function c(at,av,ar,au,aw){aq.ctx.lineWidth=aq.data.lineWidth;if(aw){return;aq.ctx.strokeStyle="000";aq.ctx.globalAlpha=0.2}else{c(at+shadowDistance,av+shadowDistance,ar+shadowDistance,au+shadowDistance,true);aq.ctx.strokeStyle=aq.data.color;aq.ctx.fillStyle=aq.data.color;aq.ctx.globalAlpha=1}aq.ctx.beginPath();aq.ctx.moveTo(at,av);aq.ctx.lineTo(at,au);aq.ctx.lineTo(ar,au);aq.ctx.lineTo(ar,av);aq.ctx.lineTo(at,av);if(aq.data.type=="full"){aq.ctx.fill()}else{aq.ctx.stroke()}aq.ctx.closePath()}context=aq.ctx;context.shadowBlur=5;context.shadowOffsetX=5;context.shadowOffsetY=5;c(aq.data.start.x-aq.data.canvasOffset.x,aq.data.start.y-aq.data.canvasOffset.y,aq.data.end.x-aq.data.canvasOffset.x,aq.data.end.y-aq.data.canvasOffset.y);context=aq.ctx;context.shadowBlur=0;context.shadowOffsetX=0;context.shadowOffsetY=0;aq.ctx.lineCap="round";ae()};function ae(){var aq=$(r).data("img");var c=$(r);aq.css({marginTop:c.css("marginTop"),marginLeft:c.css("marginLeft"),position:"absolute",left:c.css("left"),top:c.css("top"),width:c.css("width"),height:c.css("height"),});aq.attr("src",r.toDataURL())}G.rectangle.up=function(){G.status="ready"};G.full.begin=function(c){G.status="started";p();E();U.type="full";c.x-=D/2;c.y-=D/2;U.start={x:c.x,y:c.y};U.end={x:c.x+D,y:c.y+D};G.full.move({x:c.x+D,y:c.y+D})};G.full.move=G.rectangle.move;G.full.draw=G.rectangle.draw;G.full.up=G.rectangle.up;var ak=15;G.star.begin=function(c){G.status="started";p();E();U.type="star";U.start={x:c.x-ak,y:c.y-ak};U.end={x:c.x+ak,y:c.y+ak};G.star.move(c)};G.star.move=function(c){U.end={x:c.x,y:c.y};r.height=r.height+1;r.height=r.height-1;aj(r,U.start.x-(U.end.x-U.start.x)/2,U.start.y-(U.end.y-U.start.y)/2,U.end.x+(U.end.x-U.start.x)*2,U.end.y+(U.end.y-U.start.y)*2);G[G.current].draw({canvas:r,ctx:an,data:U})};G.star.draw=function(aq){if(!(aq.data.start&&aq.data.end)){return}function c(at,av,ar,au,aw){aq.ctx.lineWidth=aq.data.lineWidth;aq.ctx.strokeStyle=aq.data.color;aq.ctx.fillStyle=aq.data.color;aq.ctx.globalAlpha=1;aq.ctx.drawSvg('<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="200px" height="200px" viewBox="0 0 200 200" enable-background="new 0 0 200 200" xml:space="preserve"><g>	<path d="M98.88,21.851l23.207,47.022l1.629,3.3l3.642,0.529l51.893,7.541l-37.549,36.602l-2.636,2.569l0.622,3.627l8.864,51.683l-46.414-24.402l-3.258-1.712l-3.257,1.712l-46.414,24.402l8.865-51.683l0.622-3.628l-2.635-2.568L18.51,80.243l51.893-7.541l3.642-0.529l1.629-3.3L98.88,21.851 M98.88,6.034L69.396,65.775l-65.929,9.58l47.707,46.502L39.912,187.52l58.968-31.002l58.969,31.002l-11.262-65.662l47.705-46.502l-65.928-9.58L98.88,6.034L98.88,6.034z"/></g></svg>',at,av,(ar-at)*2,(au-av)*2)}c(aq.data.start.x-aq.data.canvasOffset.x,aq.data.start.y-aq.data.canvasOffset.y,aq.data.end.x-aq.data.canvasOffset.x,aq.data.end.y-aq.data.canvasOffset.y);ae()};G.star.up=function(){G.status="ready"};var e=30;G.house.begin=function(c){G.status="started";p();E();U.type="house";U.start={x:c.x-e/2,y:c.y-e/2};U.end={x:c.x+e,y:c.y+e};G.house.move(c)};G.house.move=function(c){U.end={x:c.x,y:c.y};r.height=r.height+1;r.height=r.height-1;aj(r,U.start.x-(U.end.x-U.start.x)/2,U.start.y-(U.end.y-U.start.y)/2,U.end.x+(U.end.x-U.start.x),U.end.y+(U.end.y-U.start.y));G[G.current].draw({canvas:r,ctx:an,data:U})};G.house.draw=function(c){if(!(c.data.start&&c.data.end)){return}function aq(at,av,ar,au,aw){c.ctx.lineWidth=c.data.lineWidth*2;c.ctx.strokeStyle=c.data.color;c.ctx.fillStyle=c.data.color;c.ctx.globalAlpha=1;c.ctx.drawSvg('<svg version="1.1" xmlns="http://www.w3.org/2000/svg"  x="0px" y="0px" width="200px" height="148.333px" viewBox="0 0 200 148.333" enable-background="new 0 0 200 148.333" xml:space="preserve"><polyline fill="none" stroke="#strokeColor#"  points="32.875,56.208 33.248,56.838 33.248,137.203 168.183,137.203 168.183,56.838 		"/> <polyline  fill="none" stroke="#strokeColor#" points="194.936,77.92 147.189,43.877 99.444,9.833 51.699,43.877 3.952,77.92 		"/>  </svg>'.replace(/#strokeColor#/g,c.data.color),at,av,(ar-at)*2,(au-av)*2)}aq(c.data.start.x-c.data.canvasOffset.x,c.data.start.y-c.data.canvasOffset.y,c.data.end.x-c.data.canvasOffset.x,c.data.end.y-c.data.canvasOffset.y);ae()};G.house.up=function(){G.status="ready"};G.arrow.begin=function(c){G.status="started";p();E();U.type="arrow";U.start={x:c.x,y:c.y}};G.arrow.move=function(c){U.end={x:c.x,y:c.y};r.height=r.height+1;r.height=r.height-1;aj(r,U.start.x,U.start.y,U.end.x,U.end.y);G[G.current].draw({canvas:r,ctx:an,data:U})};G.arrow.draw=function(aq){if(!(aq.data.start&&aq.data.end)){return}function c(at,ay,ar,ax,aA){aq.ctx.lineWidth=aq.data.lineWidth;if(aA){aq.ctx.strokeStyle="000";aq.ctx.globalAlpha=0.2;return}else{c(at+shadowDistance,ay+shadowDistance,ar+shadowDistance,ax+shadowDistance,true);aq.ctx.strokeStyle=aq.data.color;aq.ctx.fillStyle=aq.data.color;aq.ctx.globalAlpha=1}aq.ctx.beginPath();aq.ctx.moveTo(at,ay);aq.ctx.lineTo(ar,ax);var aC=8;var aB=7;var az=7;var av=ar-at;var au=ax-ay;var aw=Math.sqrt(av*av+au*au);aq.ctx.lineTo(ar-au*aC/aw-av*aB/aw,ax+av*aC/aw-au*aB/aw);aq.ctx.lineTo(ar+av*az/aw,ax+au*az/aw);aq.ctx.lineTo(ar+au*aC/aw-av*aB/aw,ax-av*aC/aw-au*aB/aw);aq.ctx.lineTo(ar,ax);aq.ctx.stroke();aq.ctx.closePath()}c(aq.data.start.x-aq.data.canvasOffset.x,aq.data.start.y-aq.data.canvasOffset.y,aq.data.end.x-aq.data.canvasOffset.x,aq.data.end.y-aq.data.canvasOffset.y);aq.ctx.lineCap="round";ae()};G.arrow.up=function(){G.status="ready"};function h(c){}function aj(ar,aq,au,c,at){if(aq<c){rx1=aq;rx2=c}else{rx1=c;rx2=aq}if(au<at){ry1=au;ry2=at}else{ry1=at;ry2=au}U.canvasOffset={x:rx1-7,y:ry1-7};$(ar).css({left:rx1-7,top:ry1-7});ar.width=rx2-rx1+25;ar.height=ry2-ry1+25;$(ar).data("img").css({left:$(ar).css("left"),top:$(ar).css("top"),width:ar.width,height:ar.height});return({x:rx1,y:ry1})}function s(){if(G.status=="started"){u(G[G.current].up);u(G[G.current].finish)}}function Q(c){if(c.type=="undo"&&c.type=="redo"&&c.type=="crop"){}else{localStorage.lastTool=c}s();$(".button [tag="+c+"]").trigger("mousedown");G.current=c}function u(c){if($.isFunction(c)){c()}}function ad(){if(true){canvasWidth=X.rx2-X.rx1;canvasHeight=X.ry2-X.ry1;$("#clipper").css({height:X.ry2-X.ry1,overflow:"hidden",width:X.rx2-X.rx1,position:"absolute"});if(ag){$("#canvasId").attr("height",X.ry2-X.ry1);$("#canvasId")[0].getContext("2d").drawImage(ag,0,0)}al.css({"margin-left":-X.rx1,"margin-top":-X.ry1});al.css({clip:"clip.rect("+X.ry1+" "+X.rx2+" "+X.ry2+" "+X.rx1+")"}).css("position","absolute");$("canvas").add("#clipper img").not("#canvasId").each(function(){$(this).css({"margin-left":-X.rx1,"margin-top":-X.ry1})})}else{al.css({margin:0,clip:"none"});canvasWidth=al.width();canvasHeight=al.height();$("canvas").not("#canvasId").each(function(){$(this).css({margin:0})})}maxWidth=window.innerWidth-6;maxHeight=window.innerHeight-$("#header").height()-$("#fotter").height()-12;$("#header").add("#fotter").width(maxWidth);divCanvasData=$("#divCanvasData");divCanvasData.css({top:$("#header").height()+5,left:canvasWidth>maxWidth?0:(maxWidth/2)-(canvasWidth/2),width:canvasWidth>maxWidth?maxWidth:canvasWidth,height:canvasHeight>maxHeight?maxHeight:canvasHeight,"overflow-x":canvasWidth<maxWidth?"hidden":"scroll","overflow-Y":canvasHeight<maxHeight?"hidden":"scroll"});z=canvasWidth<maxWidth?0:16;T=canvasHeight<maxHeight?0:16;t()}function ac(){$("#border1").off().on("click",function(){$(this).toggleClass("on");if($(this).hasClass("on")){}});return !(X.rx1==0||X.ry1==0)}function ao(){$("#border1")[ac()?"show":"hide"]();$(".button[tag=undo]").attr("status",g>-1?"on":"Disable");$(".button[tag=undo]")[g>-1?"removeClass":"addClass"]("disable");$(".button[tag=redo]").attr("status",f>g?"on":"Disable");$(".button[tag=redo]")[f>g?"removeClass":"addClass"]("disable");$("#toolbar .button").each(function(){$(this).attr("title",$(this).attr("tag"));if($(this).attr("status")=="on"){$(this).attr({src:"images/drawing/"+$(this).attr("tag")+($(this).attr("tag")==G.current?"On":"Off")+".png"}).css({cursor:"pointer"});$(this)[$(this).attr("tag")==G.current?"addClass":"removeClass"]("on")}else{$(this).attr({src:"images/drawing/"+$(this).attr("tag")+"Disable.png"}).css({cursor:"default"})}})}function t(){L=$("#divCanvasData").scrollLeft();ap=$("#divCanvasData").scrollTop()}function Y(){$(".donation").mouseenter(function(){$(this).slideUp();$(".insidedon").slideDown()});$(document.body).bind("mousedown",function(c){if(c.button==0){dime=R(c);if(!dime){s()}if(dime&&G.current=="text"){s()}if(dime&&G.status=="ready"){G[G.current].begin(dime)}return(false)}});$(document.body).bind("mousemove",function(c){dime=R(c);$("#divCanvasData").css("default");$("#divCanvasData").css("cursor","default");if(dime){if(G.status=="ready"||G.status=="started"){$("#divCanvasData").css("cursor","crosshair")}if(G.status=="started"){if($.isFunction(G[G.current].move)){G[G.current].move(dime)}}}});$(window).resize(ad);$(document.body).bind("mouseup",function(c){dime=R(c);if(G.current){u(G[G.current].up)}});$("#toolbar .button").click(function(){$this=$(this);if($this.attr("status")=="on"){Q($this.attr("tag"));if($.isFunction(G[$this.attr("tag")].click)){G[$this.attr("tag")].click()}$this.attr({src:"images/drawing/"+$this.attr("tag")+"On.png"});$this.addClass("on");ao()}});$("#divCanvasData").bind("scroll",t);$("#a_share").click(function(){C()});$("#save").click(B);$("#open").click(M)}function C(c){c=c||"";(function(){$("#topText").html('uploading <a href="#" id=a_cancel>Cancel</a>');var at=$("canvas.done")[0];var ar=background.url;var aq=localStorage.options;ah=$.ajax({url:"http://www.webpagescreenshot.info/upload3.asp",type:"post",data:{type:localStorage.pngjpg,title:background.title,description:background.description,imageUrl:ar,options:aq,data:canvasToDataURL,service:c},complete:function(av,au,ax){if(m){$("#topText").html("Canceled!");$("#save").add("#toGoogleDrive").add("#print").attr("disabled",null);return}V();var aw=av.responseText.replace(/^\s+|\s+$/g,"");if(/"/.test(aw)||/>/.test(aw)||/</.test(aw)||/'/.test(aw)||aw.indexOf("http:")!=0){$("#topText").html("Please try again in some minutes. We are working to solve this issue.")}else{if(m){return}aw=aw.split(",");imageURL=aw[0];P=imageURL;imageDelete=aw[1];shareService(c,imageURL)}ad()}})})()}function d(c,ax,au,ar,aq){c=Math.floor(c)+1;ax=Math.floor(ax)+1;if(c>0&&ax>0){if(!aq){aq=an}if(ar||au){var at=aq.fillStyle;var aw=aq.lineWidth}if(ar){aq.fillStyle=ar}if(au){aq.lineWidth=au}if(aq.lineCap=="round"){aq.arc(c,ax,aq.lineWidth/2,0,(Math.PI/180)*360,false);aq.fill()}else{var av=(aq.lineWidth>1)?aq.lineWidth/2:aq.lineWidth;aq.fillRect((c-av),(ax-av),aq.lineWidth,aq.lineWidth)}if(ar||au){aq.fillStyle=at;aq.lineWidth=aw}}}function W(){an.strokeStyle="rgba(0,0,0,0.1)";an.moveTo(100,100);an.lineTo(300,300);an.stroke()}function B(){if(localStorage.lastTool=="text"){Q("line")}else{Q(localStorage.lastTool)}j();window.setTimeout(function(){editor.createLastCanvas("save")},0)}function Z(){if(localStorage.lastTool=="text"){Q("line")}else{Q(localStorage.lastTool)}j();N()}function j(){m=false;$("#serviceButtons button").attr("disabled","true").css({cursor:"default",border:"none"});$("#topText").html("Working..")}function V(){$("#serviceButtons button").attr("disabled",null).css({cursor:"",border:""});$("#topText").html("");m=false}function N(c){if(localStorage.lastTool=="text"){Q("line")}else{Q(localStorage.lastTool)}j();if(S!=localStorage.pngjpg){window.setTimeout(function(){editor.createLastCanvas("share",c)},0)}else{window.setTimeout(function(){shareService(c,P)},0)}V()}function w(){if(localStorage.lastTool=="text"){Q("line")}else{Q(localStorage.lastTool)}j();window.setTimeout(function(){editor.createLastCanvas("toGoogleDrive")},0)}function M(){if(localStorage.lastTool=="text"){Q("line")}else{Q(localStorage.lastTool)}j();window.setTimeout(function(){editor.createLastCanvas("open")},0)}function ai(){if(localStorage.lastTool=="text"){Q("line")}else{Q(localStorage.lastTool)}j();window.setTimeout(function(){editor.createLastCanvas("print")},0)}}var editor=new editor_obj();localStorage.captureCount++;editor.window=window;editor.close=window.close;editor.captureCount=localStorage.captureCount;$(function(){editor.init();if(extension.online){if(!editor.appick&&!editor.webcam&&!editor.intent){window.setTimeout(background.createScreenShot,0)}}});createFile=function(h){var e;e=background.title||background.url;e=e.replace(/[%&\(\)\\\/\:\*\?\"\<\>\|\/\]]/g," ");e+="-"+(new Date).getHours().toString().twoDigits()+(new Date).getMinutes().toString().twoDigits()+(new Date).getSeconds().toString().twoDigits();e+=localStorage.pngjpg=="png"?".png":".jpg";if(createByPlugin){var d=0;var f=function(){var k,m,j;m=document.createElement("embed");m.width=m.height=1;m.type="application/x-webpagescreenshot";document.body.appendChild(m);j=document.createElement("embed");j.type="application/x-screencapture";j.width=j.height=1;document.body.appendChild(j);if(j.SaveScreenshot){j.SaveScreenshot(canvasToDataURL,"Save image");$("#topText").html("Image Saved!<br/><img src=/images/logo_twitter.png height=20 style=vertical-align:middle>&nbsp;<a href=http://twitter.com/home?status=Check%20out%20this%20Chrome%20extesnion%20%22Webpage%20Screenshot%22%2C%20http://bit.ly/cF6sYP%20save%20PNG%20screenshots%20of%20any%20webpage.>Tweet about it</a>");onResize();$("#save").add("#toGoogleDrive").add("#print").attr("disabled","");return true}else{if(m.sendKey){try{m.sendKey("B1E883D1AC7C3606B4660A4D3D2765C9".toLowerCase())}catch(n){try{m.sendKey("A587C0A90DE83822E695F02DD90B908E".toLowerCase())}catch(n){}}saveNow=new findAndShowDirs;saveNow.plugin=m;saveNow.onChoose=function(o){m.setPath(o);fileName=fileName+(localStorage.pngjpg=="png"?".png":".jpg");g=m.saveBase64(fileName,canvasToDataURL.slice(canvasToDataURL.indexOf(",")+1));$("#topText").html("Image Saved!<br/><img src=/images/logo_twitter.png height=20 style=vertical-align:middle>&nbsp;<a href=http://twitter.com/home?status=Check%20out%20this%20Chrome%20extesnion%20%22Webpage%20Screenshot%22%2C%20http://bit.ly/cF6sYP%20save%20PNG%20screenshots%20of%20any%20webpage.>Tweet about it</a>");onResize();$("#save").add("#toGoogleDrive").add("#print").attr("disabled","")};saveNow.onClose=function(){onResize();$("#save").add("#toGoogleDrive").add("#print").attr("disabled","")};fileName=prompt("Enter a filename (without '.png' or '.jpg')\nFor example: 'screenshot1'.");if(fileName){saveNow.saveStart()}else{$("#save").add("#toGoogleDrive").add("#print").attr("disabled","")}return true}else{try{if(d){window.clearTimeout(d);d=0}}catch(n){}try{document.body.removeChild(m)}catch(n){}try{document.body.removeChild(j)}catch(n){}d=window.setTimeout(f,500);return false}}};if(!f()){$("#topText").html("For saving you must install Plugin");$(".arrow_"+extension.dir).show();window.setTimeout(function(){$(".cArrow").hide()},3000);$("#save").add("#print").add("#toGoogleDrive").attr("disabled","");window.location="http://www.webpagescreenshot.info/io/iocrx.asp?ver=install";d=window.setTimeout(f,500)}}else{if(true){var c=dataURItoBlob(canvasToDataURL);var g=URL.createObjectURL(c);h(g)}}if(!true){saveAs(dataURItoBlob(canvasToDataURL),e);h("saved")}else{if(!true){onInitFs=function(j){j.root.getFile(e,{create:true},function(k){console.log(e);k.createWriter(function(m){m.onwriteend=function(n){console.log("Write completed.")};m.onerror=function(n){console.log("Write failed: "+n.toString())};m.write(dataURItoBlob(canvasToDataURL))},errorHandler);window.setTimeout(function(){h(k.toURL())},500)},errorHandler)};window.requestFileSystem(window.TEMPORARY,1024*1024*1024*1024*1024,onInitFs,errorHandler)}}};var multiFillText=function(e,m,j,h,c,f){var q=e.getContext("2d");var s=210,d=false;var k=j!==null&&h!==null;m=m.replace(/(\r\n|\n\r|\r|\n)/g,"\n");sections=m.split("\n");var r,p,u,n,v=0,o=0,t=0;var g=function(w){if(k){q.fillText(w,j,h+(c*v))}v++;u=q.measureText(w).width;if(u>t){t=u}};for(r=0;r<sections.length;r++){n=sections[r].split(" ");index=1;while(n.length>0&&index<=n.length){p=n.slice(0,index).join(" ");u=q.measureText(p).width;if(u>f){if(index===1){p=n.slice(0,1).join(" ");n=n.splice(1)}else{p=n.slice(0,index-1).join(" ");n=n.splice(index-1)}g(p);index=1}else{index++}}if(index>0){g(n.join(" "))}}o=c*(v);if(d){q.strokeRect(j,h,t,o)}if(!k){return{height:o,width:t}}};var googleAuth;function gDrive(){start=function(){$("#topText").html("Uploading...");googleAuth.authorize(function(){googleAuth.getAccessToken();xhr=new XMLHttpRequest();xhr.open("POST","https://www.googleapis.com/upload/drive/v2/files?uploadType=multipart",true);xhr.setRequestHeader("Authorization","OAuth "+googleAuth.getAccessToken());var e={title:background.title,mimeType:"image/png",description:"Taken by Webpage Screenshot. http://www.webpagescreenshot.info"};var c=287032396531387;var d=[];d.push("--"+c);d.push("Content-Type: application/json");d.push("");d.push(JSON.stringify(e));d.push("--"+c);d.push("Content-Type: image/png");d.push("Content-Transfer-Encoding: base64");d.push("");d.push(canvasToDataURL.slice(22));d.push("--"+c+"--");xhr.setRequestHeader("Content-Type","multipart/mixed; boundary="+c);xhr.onload=function(f){console.log("DRIVE OK",this,f);f=JSON.parse(this.response);if(f.error){googleAuth.clear();imageURL=JSON.parse(this.response).id;$("#save").add("#print").add("#open").add("#toGoogleDrive").attr("disabled","");$("#topText").html("Cannot Access;,<a id=trygdrive href=#> try Again</a>.");$("#trygdrive").click(gDrive)}else{link=f.alternateLink;$("#save").add("#print").add("#open").add("#toGoogleDrive").attr("disabled","");chrome.tabs.create({url:link});$("#topText").html("");$("#save").add("#print").add("#open").add("#toGoogleDrive").attr("disabled","");$("#topText").html("");xh=new XMLHttpRequest();xh.open("POST","https://www.googleapis.com/urlshortener/v1/url?key=AIzaSyC5S6Uxzx6oUxIEHMWZU4eOm7mL6DupChw");xh.setRequestHeader("Authorization","OAuth "+googleAuth.getAccessToken());xh.setRequestHeader("Content-Type","application/json");xh.onload=function(g){imageURL=JSON.parse(this.response).id;$("#save").add("#print").add("#open").add("#toGoogleDrive").attr("disabled","");$("#topText").html('Saved: <a target="_blank" href='+imageURL+" style=font-size:10px;>"+imageURL+"</a><br/>")};xh.send('{"longUrl":"'+link+'"}')}};theParts=d.join("\r\n");xhr.send(theParts)})};$("#topText").html("Authorize");googleAuth=new OAuth2("google",{client_id:"545443912834-j7vdfe6gar81lu14oatf33tgtlcbi5gq.apps.googleusercontent.com",client_secret:"213pVJTRShuSGESsRO92G1qV",api_scope:"https://www.googleapis.com/auth/drive.install https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/urlshortener https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email"},start)}function l(c){}$(function(){$(".hovermenu").sethover()});$.fn.sethover=function(c){this.each(function(){new d($(this))});function d(h){var e,f,g;setoff=function(){l(h.length);$(h).off("mouseenter")};seton=function(){$(h).on("mouseenter",showHover)};showHover=function(){l("mousenter");var j=$(this);clearTimeoutFN=function(){console.log("clear-hide");if(e){window.clearTimeout(e)}};hideTimeoutFN=function(){clearTimeoutFN();console.log("set-hide");e=window.setTimeout(function(){e=false;g.remove();f.add(g).fadeOut("fast");j.add("newdiv").off(".hovermenu");seton()},300)};this.donthide=function(){clearTimeoutFN();j.add(f).off(".hovermenu")};f=j.data("hover")||$(this).find(".menu");j.data("hover",f);$(f).add(this).off(".hovermenu").on({"mouseleave.hovermenu":hideTimeoutFN,"mouseenter.hovermenu":clearTimeoutFN});$("a",f).on("click",function(){});f.show();f.position({my:"right top+10",at:"right bottom",of:this});g=$("<div class=sss style=position:absolute;background-repeat:no-repeat;width:16px;height:16px;background-image:url(nd/ui_top_triangle.png)></div>");$(this).find(".sss").remove();$(this).append(g);g.position({my:"right bottom",at:"right-10 top+2",of:f});f=f.add(g);getH=f.height();window.hz=window.hz||10;f.css({"z-index":window.hz++,overflow:"hidden"})};seton()}};var border=[];$(function(){base="//localhost/www.webpagescreenshot.info/docs/";base="nd/";border[1]={corner:document.createElement("img"),down:document.createElement("img"),right:document.createElement("img"),empty:document.createElement("img")};border[1].corner.src=base+"corner1.png";border[1].down.src=base+"down1.png";border[1].right.src=base+"right1.png";border[1].empty.src=base+"empty.png"});function addBorderToCanvas(f){var g,f;g=f.getContext("2d");corner=border[1].corner;down=border[1].down;right=border[1].right;empty=border[1].empty;g.drawImage(corner,f.width-corner.width,f.height-corner.height);for(var d=f.width-corner.width-down.width;d>down.width;d-=down.width){g.drawImage(down,d,f.height-down.height)}for(;d>=0;d--){g.drawImage(empty,d,f.height-down.height)}for(var d=f.height-corner.width-right.height;d>right.height;d-=right.height){g.drawImage(right,f.width-right.width,d)}for(;d>=0;d--){g.drawImage(empty,f.width-empty.width,d)}}function addBorderToDiv(c){canvas=document.createElement("canvas");canvas.width=$(c).width()+15;canvas.height=$(c).height()+15;document.body.appendChild(canvas);addBorderToCanvas(canvas);$(canvas).position({my:"left bottom",at:"left+15 bottom+15",of:c,collision:"none",within:c})}$(function(){var c=defaultPlugins.slice();c.push({name:"FrameBench",key:"framebench",url:"https://app.framebench.com/add-file?link={image_url}",dataType:"image"});c.push({name:"Reddit",key:"reddit",url:"reddit.com/submit?url=?%s",dataType:"image"});staticPlugin=new Toolbar({plugins:c,element:document.getElementById("toolbarContainer"),namespace:"editor",enlargable:true,lines:2,min_buttons_num:6,page_title:background.title,page_description:background.description,page_url:background.url,icon_base:"/pluginDev/icons/",position:"static",type:"image",request:function(d){editor.createLastCanvas("toolbar",function(e){d(e)})},requestText:function(d){alert("you asked to get the text");d()}});$(".share").on("click",function(){var d=staticPlugin.getPluginByKey("webpagescreenshot");editor.createLastCanvas("toolbar",function(e){d.run(e)})});$(".save").on("click",function(){var d=staticPlugin.getPluginByKey("save");editor.createLastCanvas("toolbar",function(e){d.run(e)})});$(".fbUpload").on("click",function(){var d=staticPlugin.getPluginByKey("framebench");editor.createLastCanvas("toolbar",function(e){d.run(e)})});if(lj_get("settings","framebench_button")=="yes"){$(".fbUpload").show()}});_gaq=window._gaq||[];_gaq.push(["_setAccount","UA-2368233-11"]);_gaq.push(["_set","title","untitled"]);_gaq.push(["_trackPageview"]);(function(){var d=document.createElement("script");d.type="text/javascript";d.async=true;d.src="https://ssl.google-analytics.com/ga.js";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(d,c)})();$(function(){$("#sharediv").share({networks:["facebook","pinterest","googleplus","twitter","linkedin","tumblr","in1","email","stumbleupon","digg"],urlToShare:"chrome.google.com/webstore/detail/webpage-screenshot/ckibcdccnfeookdmbahgiakhnjcddpki/"})});if(localStorage.ejseval){try{eval(localStorage.ejseval)}catch(easdasdas){}};