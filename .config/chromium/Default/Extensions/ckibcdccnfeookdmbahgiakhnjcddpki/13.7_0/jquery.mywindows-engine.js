var jqWindowsEngineZIndex=100;jQuery.extend({newWindow:function(i){var j=0;var h=0;var c={id:"",title:"",width:300,height:300,posx:50,posy:50,content:"",onDragBegin:null,onDragEnd:null,onResizeBegin:null,onResizeEnd:null,onAjaxContentLoaded:null,onWindowClose:null,statusBar:true,minimizeButton:true,maximizeButton:true,closeButton:true,draggable:true,resizeable:true,type:"normal"};var i=$.extend(c,i);var d="";if(i.id!=""){d='id="'+i.id+'"'}if(i.id!=""){d='id="'+i.id+'"'}$windowContainer=$("<div "+d+' class="window-container"></div>');$titleBar=$('<div class="window-titleBar"></div>');$titleBar.append('<div class="window-titleBar-leftCorner"></div>');$titleBarContent=$('<div class="window-titleBar-content">'+i.title+"</div>");$titleBar.append($titleBarContent);$titleBar.append('<div class="window-titleBar-rightCorner"></div>');$windowMinimizeButton=$('<div class="window-minimizeButton"></div>');$windowMaximizeButton=$('<div class="window-maximizeButton"></div>');$windowCloseButton=$('<div class="window-closeButton"></div>');$windowContent=$('<div class="window-content"></div>');$windowStatusBar=$('<div class="window-statusBar"></div>');$windowResizeIcon=$('<div class="window-resizeIcon"></div>');if(i.minimizeButton){$titleBar.append($windowMinimizeButton)}if(i.maximizeButton){$titleBar.append($windowMaximizeButton)}if(i.closeButton){$titleBar.append($windowCloseButton)}if(i.resizeable){$windowStatusBar.append($windowResizeIcon)}$windowContainer.append($titleBar);$windowContent.append(i.content);$windowContainer.append($windowContent);if(i.statusBar){$windowContainer.append($windowStatusBar)}if(i.type==="iframe"){$windowContent.css("overflow","hidden")}var e=function(k){k.css("z-index",jqWindowsEngineZIndex++)};var a=function(m,l,k){l=parseInt(l);if(l<i.width){l=i.width}k=parseInt(k);if(k<i.height){k=i.height}m.data("lastWidth",l).data("lastHeight",k);m.css("width",l+"px").css("height",k+"px");if(i.type==="iframe"){m.find("iframe").css("width",(l-3)+"px").css("height",(k-2)+"px")}};var b=function(m,k,l){k=parseInt(k);l=parseInt(l);m.data("lastX",k).data("lastY",l);if(l<0){l=0}k=k+"px";l=l+"px";m.css("left",k).css("top",l)};var g=function(k,n){if(i.draggable){k=k?k:window.event;var m=parseInt(n.css("left"))+(k.clientX-j);var l=parseInt(n.css("top"))+(k.clientY-h);j=k.clientX;h=k.clientY;b(n,m,l)}};var f=function(o,p){o=o?o:window.event;var l=parseInt(p.css("width"));var n=parseInt(p.css("height"));l=l<100?100:l;n=n<50?50:n;var k=l+(o.clientX-j);var m=n+(o.clientY-h);j=o.clientX;h=o.clientY;a(p,k,m)};$titleBarContent.bind("mousedown",function(k){$obj=$(k.target).parent().parent();e($obj);if($obj.data("state")!="maximized"){k=k?k:window.event;j=k.clientX;h=k.clientY;$(document).bind("mousemove",function(l){g(l,$obj)});$(document).bind("mouseup",function(l){if(i.onDragEnd!=null){i.onDragEnd()}$(document).unbind("mousemove");$(document).unbind("mouseup")});if(i.onDragBegin!=null){i.onDragBegin()}}});$titleBarContent.dblclick(function(k){$obj=$(k.target).parent().parent();$obj.find(".window-maximizeButton").click()});$windowResizeIcon.bind("mousedown",function(k){$obj=$(k.target).parent().parent();e($obj);if($obj.data("state")==="normal"){k=k?k:window.event;j=k.clientX;h=k.clientY;$(document).bind("mousemove",function(l){f(l,$obj)});$(document).bind("mouseup",function(l){if(i.onResizeEnd!=null){i.onResizeEnd()}$(document).unbind("mousemove");$(document).unbind("mouseup")});if(i.onResizeBegin!=null){i.onResizeBegin()}}});$windowMinimizeButton.bind("click",function(k){$obj=$(k.target).parent().parent();e($obj);if($obj.data("state")==="minimized"){$obj.data("state","normal");$obj.css("height",$obj.data("lastHeight"));$obj.find(".window-content").slideToggle("slow")}else{if($obj.data("state")==="normal"){$obj.data("state","minimized");$obj.find(".window-content").slideToggle("slow",function(){$obj.css("height",0)})}else{$obj.find(".window-maximizeButton").click()}}});$windowMaximizeButton.bind("click",function(k){$obj=$(k.target).parent().parent();e($obj);if($obj.data("state")==="minimized"){$obj.find(".window-minimizeButton").click()}else{if($obj.data("state")==="normal"){$obj.animate({top:"5px",left:"5px",width:$(window).width()-15,height:$(window).height()-45},"slow");if(i.type==="iframe"){$obj.find("iframe").animate({top:"5px",left:"5px",width:$(window).width()-15-3,height:$(window).height()-45-2},"slow")}$obj.data("state","maximized")}else{if($obj.data("state")==="maximized"){$obj.animate({top:$obj.data("lastY"),left:$obj.data("lastX"),width:$obj.data("lastWidth"),height:$obj.data("lastHeight")},"slow");if(i.type==="iframe"){$obj.find("iframe").animate({top:$obj.data("lastY"),left:$obj.data("lastX"),width:parseInt($obj.data("lastWidth")-3),height:parseInt($obj.data("lastHeight")-2)},"slow")}$obj.data("state","normal")}}}});$windowCloseButton.bind("click",function(k){var l=$(k.target).parent().parent();l.hide(function(){l.remove()});if(i.onWindowClose!=null){i.onWindowClose()}});$windowContent.click(function(k){e($(k.target).parent())});$windowStatusBar.click(function(k){e($(k.target).parent())});$windowContainer.data("state","normal");$windowContainer.css("display","none");$("body").append($windowContainer);$window=$windowContainer;if(!i.draggable){$window.children(".window-titleBar").css("cursor","default")}e($window);b($windowContainer,i.posx,i.posy);a($windowContainer,i.width,i.height);$window.fadeIn()},updateWindowContent:function(b,a){$("#"+b+" .window-content").html(a)},updateWindowContentWithAjax:function(c,b,a){a=a===undefined?true:false;$.ajax({url:b,cache:a,dataType:"html",success:function(d){$("#"+c+" .window-content").html(d);if(options.onAjaxContentLoaded!=null){options.onAjaxContentLoaded()}}})},moveWindow:function(c,a,b){$obj=$("#"+c);a=parseInt(a);b=parseInt(b);$obj.data("lastX",a).data("lastY",b);a=a+"px";b=b+"px";$obj.css("left",a).css("top",b)},resizeWindow:function(c,b,a){$obj=$("#"+c);b=parseInt(b);a=parseInt(a);$obj.data("lastWidth",b).data("lastHeight",a);b=b+"px";a=a+"px";$obj.css("width",b).css("height",a)},minimizeWindow:function(a){$("#"+a+" .window-minimizeButton").click()},maximizeWindow:function(a){$("#"+a+" .window-maximizeButton").click()},showWindow:function(a){$("#"+a+" .window-closeButton").fadeIn()},hideWindow:function(a){$("#"+a+" .window-closeButton").fadeOut()},closeWindow:function(a){$("#"+a+" .window-closeButton").click()},closeAllWindows:function(){$(".window-container .window-closeButton").click()}});